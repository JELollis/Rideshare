{% extends "base.html" %}
{% block content %}
<h1 class="text-2xl font-bold mb-4">Users</h1>

{% if error %}<div class="text-red-400 mb-4">{{ error }}</div>{% endif %}

{% if user.is_admin %}
<form method="post" action="/users/ui" class="p-4 bg-slate-900 rounded-2xl grid md:grid-cols-5 gap-3 mb-6">
  <input name="username" placeholder="Username" class="px-3 py-2">
  <input name="password" type="password" placeholder="Password" class="px-3 py-2">
  <select name="driver_id" class="px-3 py-2">
    <option value="">(no driver)</option>
    {% for d in drivers %}<option value="{{ d.id }}">{{ d.name }}</option>{% endfor %}
  </select>
  <label class="flex items-center gap-2"><input type="checkbox" name="is_admin"> Admin</label>
  <button class="btn">Add User</button>
</form>
{% endif %}

<table class="w-full text-left border-collapse">
  <thead class="text-slate-300">
    <tr>
      <th class="py-2">Username</th>
      <th>Admin</th>
      <th>Driver</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for u in users %}
      <tr style="border-top:1px solid #1f2937">
        <td class="py-2">{{ u.username }}</td>
        <td>{% if u.is_admin %}✔{% else %}—{% endif %}</td>
        <td>{{ u.driver.name if u.driver else '' }}</td>
        <td>
          <a class="btn" style="padding:4px 8px" href="/users/edit/{{ u.id }}">Edit</a>
          <form method="post" action="/users/delete/{{ u.id }}" style="display:inline" onsubmit="return confirm('Delete this user?')">
            <button class="btn" style="background:#dc2626;padding:4px 8px">Delete</button>
          </form>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
